{% extends "load_planer/layout.html" %}
{% load static %}

{% block body %}
    <div class="container text-center" >
        <div class="row row-cols-4" id="top_nav_row"></div>
        <br>
        <div class="row">
            <div id="profile_main" class="col-12 col-md-9">
                <div class="row">
                    <h4>Driver details:</h4>
                    
                </div>
                <div class="row row-cols-2">
                    <div class="col text-end">
                        <img src="{% static 'load_planer/img/profile.png' %}" style="width:200px;height:250px;border-radius:2%;" alt="My image">
                    </div>
                    <div class="col"> 
                        <div class="card mb-3">
                            <div class="card-header" id="profile_id:{{ profile.id }}">
                                 priofile id: <strong id="profile_strong">{{ profile.id }}</strong>
                            </div>
                            <ul class="list-group list-group-flush">
                                <li class="list-group-item card-text" id="username">username: {{ profile }}</li>
                                <li class="list-group-item card-text" id="first_name">Name: {{ profile_details.first_name }}</li>
                                <li class="list-group-item card-text" id="last_name">Lastname: {{ profile_details.last_name }}</li>
                                <li class="list-group-item card-text" id="driver_id">driver ID: <strong>{{ profile_details.driver_id }}</strong></li>

                                {% if verified.is_driver == True%}
                                <li class="list-group-item card-text" id="v_verified">Verified </li>
                                {% elif verified.is_driver == None %}
                                    <li class="list-group-item card-text" id="v_awaiting">Lacking personal data </li>
                                {% elif verified.is_planner == True %}
                                        <li class="list-group-item card-text" id="v_planner">You are a Planner! </li>
                                {% else %}
                                <li class="list-group-item card-text" id="v_not_verified">Not verified! </li>
                                {% endif %}
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
 
            </div>
            <div id="profile_right" class="col-6 col-md-3">
                <div class="col-md text-center">
                    {% if driver_form %}
                        <div class="row ">
                            <h5>Register as Driver:</h5>
                        </div>
                        <div class="row" id="unver_driver">
                            
                            <form action="{% url 'reg_driver' %}" method="post">
                                {% csrf_token %}
                                {{ driver_form }}
                                <input type="submit" value="Register" class="btn btn-success form-control">
                            </form>
                            
                        </div>  
                    {% endif %}
                </div>
            </div>

        </div>
    </div>
    <div class="container text-center">
        <h1> Profile: {{ profile }} id:{{ profile.id }}</h1>
        {% if profile_details %}
            <p> Got details</p>
            First name: {{ profile_details.first_name }}<br>
            Last name: {{ profile_details.last_name }}<br>
            Driver ID: {{ profile_details.driver_id }}
            <br><br>
            {{ verified }}
        {% else %}
            <p> Nothing to display, no Profile details provided! </p>
        {% endif %}

        {% if profile.id == request.user.id %}
        <br>
            <br><p> TODO: Let user edit user's profile</p>
        {% else %}
            {% if profile_details == None %}
                <p> This user didn't supply any details to register as Driver</p>
                {% else %}
                {% if verified.is_driver == False %}
                <form action="{% url 'verify_driver' profile.id %}" method="post">
                    {% csrf_token %}
                    <input type="submit" value="Verify driver" class="btn btn-secondary form-control">
                </form>
                {% else %}
                <form action="{% url 'verify_driver' profile.id %}" method="post">
                    {% csrf_token %}
                    <input type="submit" value="Remove driver" class="btn btn-secondary form-control">
                </form>
                {% endif %}
            {% endif %}
        {% endif %}

        {% if driver_form %}
        <form action="{% url 'reg_driver' %}" method="post">
            {% csrf_token %}
            {{ driver_form }}

        <input type="submit" value="Register" class="btn btn-primary form-control">
        </form>
        {% else %}
            {% if verified.is_driver == True%}
            <p> Verified as driver</p> {{ verified }}
            {% elif verified.is_driver == None %}
            <p> User didn't supply any details for registration. Let the Planer Edit this profile.</p>
            {% elif verified.is_planner == True %}
            <p> You are a Planner!</p>
            {% else %}
            <p> Not verified as driver, please await Verification by Planner</p>
            {% endif %}
        {% endif %}
    </div>  
{% endblock %}
{% block script %}
   <script src="{% static 'load_planer/profileView.js' %}" type="text/javascript"></script>
{% endblock %}